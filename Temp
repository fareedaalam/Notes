public class JsonPropertyTypeHandler<T> : SqlMapper.TypeHandler<T>
{
    private readonly SqlMapper.ITypeHandler innerHandler;

    public JsonPropertyTypeHandler()
    {
        this.innerHandler = SqlMapper.GetTypeHandler(typeof(T));
    }

    public override T Parse(object value)
    {
        if (value is string json)
        {
            var jsonObject = JsonConvert.DeserializeObject<Dictionary<string, object>>(json);
            var data = new Dictionary<string, object>();

            foreach (var kvp in jsonObject)
            {
                var propertyName = typeof(T).GetProperty(kvp.Key)?.Name ?? kvp.Key;
                data.Add(propertyName, kvp.Value);
            }

            return (T)this.innerHandler.Parse(data);
        }

        return (T)this.innerHandler.Parse(value);
    }

    public override void SetValue(IDbDataParameter parameter, T value)
    {
        this.innerHandler.SetValue(parameter, value);
    }
}
